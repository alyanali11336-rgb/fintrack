<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SmartSpend Elite | Apex v10.1</title>
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --brand: #6366f1; --bg: #0b0f1a; --surface: #161b2c; --surface-sub: #232a42;
            --text: #ffffff; --text-dim: #94a3b8; --success: #10b981; --danger: #f43f5e;
            --border: rgba(255,255,255,0.06); --radius: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg); color: var(--text); height: 100vh; overflow: hidden; }

        .screen { display: none; height: 100vh; overflow-y: auto; padding: 20px 20px 110px; animation: slideUp 0.3s ease-out; }
        .screen.active { display: block; }

        /* Multi-Currency Selection */
        .cur-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 20px 0; }
        .cur-item { background: var(--surface); padding: 15px; border-radius: 15px; border: 1px solid var(--border); text-align: center; cursor: pointer; transition: 0.2s; }
        .cur-item.active { border-color: var(--brand); background: rgba(99, 102, 241, 0.1); }

        .hero { background: linear-gradient(160deg, var(--brand) 0%, #000 140%); padding: 35px 25px; border-radius: var(--radius); margin-bottom: 25px; position: relative; overflow: hidden; }
        
        .tx-card { background: var(--surface); padding: 16px; border-radius: 20px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .icon-box { width: 44px; height: 44px; border-radius: 12px; background: var(--surface-sub); display: flex; align-items: center; justify-content: center; color: var(--brand); font-size: 18px; }

        nav { position: fixed; bottom: 0; width: 100%; height: 85px; background: rgba(11, 15, 26, 0.95); backdrop-filter: blur(15px); display: flex; justify-content: space-around; align-items: center; border-top: 1px solid var(--border); z-index: 1000; }
        .nav-link { color: var(--text-dim); text-align: center; font-size: 11px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: var(--brand); transform: translateY(-3px); }
        .nav-link i { font-size: 22px; margin-bottom: 4px; display: block; }

        .btn-prime { background: var(--brand); color: white; border: none; padding: 18px; border-radius: 18px; font-weight: 800; width: 100%; cursor: pointer; }
        input, select { width: 100%; padding: 16px; margin-bottom: 15px; border-radius: 14px; border: 1px solid var(--border); background: var(--surface-sub); color: white; font-size: 16px; }

        .overlay { position: fixed; inset: 0; background: var(--bg); z-index: 10000; display: none; flex-direction: column; padding: 30px; text-align: center; justify-content: center; }
        
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div id="onboarding" class="overlay" style="display: flex;">
        <i class="fas fa-globe fa-3x" style="color:var(--brand); margin-bottom:20px;"></i>
        <h2>Select Vault Currency</h2>
        <p style="color:var(--text-dim); margin-top:10px;">Choose your primary asset unit</p>
        <div class="cur-grid" id="onboarding-cur-list"></div>
        <button class="btn-prime" onclick="completeOnboarding()">Authorize Setup</button>
    </div>

    <div id="home" class="screen">
        <div class="hero">
            <p style="font-size:11px; font-weight:800; opacity:0.6; letter-spacing:1px;">TOTAL LIQUIDITY</p>
            <h1 id="total-bal" style="font-size:38px; margin:5px 0;">--</h1>
            <p style="font-size:10px; opacity:0.5;"><i class="fas fa-shield-halved"></i> Duke Core Protection Active</p>
        </div>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px; margin-bottom:25px;">
            <button class="btn-prime" style="background:var(--success);" onclick="openEntry('income')"><i class="fas fa-plus"></i> Revenue</button>
            <button class="btn-prime" style="background:var(--danger);" onclick="openEntry('expense')"><i class="fas fa-minus"></i> Expense</button>
        </div>
        <div id="tx-list"></div>
    </div>

    <div id="analytics" class="screen">
        <h2 style="margin-bottom:20px;">Financial Athletics</h2>
        <div style="background:var(--surface); padding:20px; border-radius:24px; border:1px solid var(--border); margin-bottom:25px;">
            <canvas id="apexChart" style="max-height:280px;"></canvas>
        </div>
        <div id="breakdown-list"></div>
    </div>

    <div id="system" class="screen">
        <h2 style="margin-bottom:20px;">System Console</h2>
        <div style="background:var(--surface); border-radius:20px; overflow:hidden; border:1px solid var(--border);">
            <div style="padding:18px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;" onclick="openInfo('Privacy')">
                <span><i class="fas fa-user-lock" style="margin-right:12px; color:var(--brand);"></i> Privacy Protocol</span><i class="fas fa-chevron-right"></i>
            </div>
            <div style="padding:18px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between;" onclick="window.location.href='mailto:fynovostudio@gmail.com'">
                <span><i class="fas fa-envelope" style="margin-right:12px; color:var(--brand);"></i> Email Support</span><i class="fas fa-chevron-right"></i>
            </div>
            <div style="padding:18px; color:var(--danger);" onclick="resetAll()">
                <i class="fas fa-power-off" style="margin-right:12px;"></i> Factory Reset
            </div>
        </div>
    </div>

    <div id="entry-modal" class="modal" onclick="if(event.target==this) this.style.display='none'">
        <div class="modal-content">
            <h2 id="entry-title">New Entry</h2>
            <br>
            <input type="number" id="amt" placeholder="0.00" inputmode="decimal">
            <input type="text" id="desc" placeholder="Merchant/Label">
            <select id="cat-sel">
                <option value="General">General</option>
                <option value="Salary">Salary</option>
                <option value="Food">Food</option>
                <option value="Transport">Transport</option>
                <option value="Health">Healthcare</option>
            </select>
            <button class="btn-prime" onclick="saveEntry()">Commit Transaction</button>
        </div>
    </div>

    <nav>
        <div class="nav-link active" onclick="nav('home', this)"><i class="fas fa-wallet"></i>Vault</div>
        <div class="nav-link" onclick="nav('analytics', this)"><i class="fas fa-chart-line"></i>Athletics</div>
        <div class="nav-link" onclick="nav('system', this)"><i class="fas fa-terminal"></i>System</div>
    </nav>

    <script>
        const CURS = [
            {n:'USD', s:'$'}, {n:'PKR', s:'Rs'}, {n:'EUR', s:'€'}, {n:'GBP', s:'£'}, 
            {n:'INR', s:'₹'}, {n:'AED', s:'د.إ'}, {n:'SAR', s:'﷼'}, {n:'JPY', s:'¥'}
        ];

        let db = JSON.parse(localStorage.getItem('apex_v10_db')) || [];
        let cfg = JSON.parse(localStorage.getItem('apex_v10_cfg')) || { onboard: false, cur: '$', curName: 'USD' };
        let chart = null;

        window.onload = function() {
            if(cfg.onboard) {
                document.getElementById('onboarding').style.display = 'none';
                document.getElementById('home').classList.add('active');
                renderHome();
            } else {
                renderOnboardingCur();
            }
        };

        function renderOnboardingCur() {
            const list = document.getElementById('onboarding-cur-list');
            list.innerHTML = CURS.map(c => `
                <div class="cur-item ${cfg.cur === c.s ? 'active' : ''}" onclick="setCur('${c.s}', '${c.n}', this)">
                    <b>${c.n}</b><br><small>${c.s}</small>
                </div>
            `).join('');
        }

        function setCur(s, n, el) {
            cfg.cur = s; cfg.curName = n;
            document.querySelectorAll('.cur-item').forEach(i => i.classList.remove('active'));
            el.classList.add('active');
        }

        function completeOnboarding() {
            cfg.onboard = true;
            localStorage.setItem('apex_v10_cfg', JSON.stringify(cfg));
            document.getElementById('onboarding').style.display = 'none';
            document.getElementById('home').classList.add('active');
            renderHome();
        }

        function nav(id, el) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            el.classList.add('active');
            if(id === 'analytics') renderAthletics();
        }

        function openEntry(type) {
            window.currentType = type;
            document.getElementById('entry-title').innerText = type === 'income' ? 'Deposit Assets' : 'Withdraw Assets';
            document.getElementById('entry-modal').style.display = 'flex';
        }

        function saveEntry() {
            const amt = parseFloat(document.getElementById('amt').value);
            const desc = document.getElementById('desc').value || 'General';
            const cat = document.getElementById('cat-sel').value;
            if(!amt) return;
            db.push({ type: window.currentType, amt, desc, cat, date: new Date().toLocaleDateString() });
            localStorage.setItem('apex_v10_db', JSON.stringify(db));
            document.getElementById('entry-modal').style.display = 'none';
            document.getElementById('amt').value = ''; document.getElementById('desc').value = '';
            renderHome();
        }

        function renderHome() {
            const list = document.getElementById('tx-list');
            list.innerHTML = ''; let bal = 0;
            db.slice().reverse().forEach(t => {
                const isInc = t.type === 'income';
                bal += isInc ? t.amt : -t.amt;
                list.innerHTML += `
                    <div class="tx-card">
                        <div style="display:flex; align-items:center; gap:12px;">
                            <div class="icon-box"><i class="fas ${isInc ? 'fa-arrow-up' : 'fa-arrow-down'}"></i></div>
                            <div><b>${t.desc}</b><br><small style="color:var(--text-dim)">${t.cat}</small></div>
                        </div>
                        <b style="color:${isInc ? 'var(--success)' : 'white'}">${isInc ? '+' : '-'}${cfg.cur}${t.amt.toLocaleString()}</b>
                    </div>`;
            });
            document.getElementById('total-bal').innerText = `${cfg.cur}${bal.toLocaleString()}`;
        }

        function renderAthletics() {
            const ctx = document.getElementById('apexChart').getContext('2d');
            const dataMap = {};
            db.filter(t => t.type === 'expense').forEach(e => dataMap[e.cat] = (dataMap[e.cat] || 0) + e.amt);
            
            if(chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(dataMap),
                    datasets: [{
                        data: Object.values(dataMap),
                        backgroundColor: ['#6366f1', '#10b981', '#f43f5e', '#fbbf24', '#a855f7'],
                        borderWidth: 0
                    }]
                },
                options: { cutout: '80%', plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8' } } } }
            });
        }

        function resetAll() { if(confirm("Permanently wipe vault?")) { localStorage.clear(); location.reload(); } }
        function openInfo(type) { alert(type + " Protocol: All data is stored locally on this physical hardware. No cloud sync active."); }
    </script>
</body>
</html>
